[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [02:06<02:06, 126.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [03:02<00:00, 84.82s/it] Loading checkpoint shards: 100%|██████████| 2/2 [03:02<00:00, 91.04s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.72s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.04s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.66s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.69s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.67s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.66s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.35s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.68s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.39s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.71s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.39s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.67s/it]
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.66s/it]
  0%|          | 0/100000 [00:00<?, ?it/s]  0%|          | 0/100000 [00:00<?, ?it/s]
  0%|          | 0/100000 [00:00<?, ?it/s]  0%|          | 0/100000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/khalevy/flextape/experiments/eval_pair_mistral.py", line 303, in <module>
    main(
  File "/home/khalevy/flextape/experiments/eval_pair_mistral.py", line 154, in main
    edited_model, weights_copy = apply_algo(
                                 ^^^^^^^^^^^
  File "/home/khalevy/flextape/memit/memit_main.py", line 48, in apply_memit_to_model
    deltas = execute_memit(model, tok, requests, hparams, cache_template=cache_template)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/khalevy/flextape/memit/memit_main.py", line 193, in execute_memit
    cov = get_cov(
          ^^^^^^^^
  File "/home/khalevy/flextape/memit/memit_main.py", line 274, in get_cov
    stat = layer_stats(
           ^^^^^^^^^^^^
  File "/home/khalevy/flextape/rome/layer_stats.py", line 169, in layer_stats
    loader = tally(
             ^^^^^^
  File "/home/khalevy/flextape/util/runningstats.py", line 104, in tally
    cached_state = load_cached_state(cache, args, quiet=quiet)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/khalevy/flextape/util/runningstats.py", line 1480, in load_cached_state
    dat = unbox_numpy_null(numpy.load(cachefile))
                           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/khalevy/miniconda3/lib/python3.11/site-packages/numpy/lib/npyio.py", line 444, in load
    ret = NpzFile(fid, own_fid=own_fid, allow_pickle=allow_pickle,
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/khalevy/miniconda3/lib/python3.11/site-packages/numpy/lib/npyio.py", line 190, in __init__
    _zip = zipfile_factory(fid)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/khalevy/miniconda3/lib/python3.11/site-packages/numpy/lib/npyio.py", line 103, in zipfile_factory
    return zipfile.ZipFile(file, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/khalevy/miniconda3/lib/python3.11/zipfile.py", line 1302, in __init__
    self._RealGetContents()
  File "/home/khalevy/miniconda3/lib/python3.11/zipfile.py", line 1369, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
[nltk_data] Downloading package punkt to /home/khalevy/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:09<00:00,  4.66s/it]
